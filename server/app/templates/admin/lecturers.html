{% extends 'admin/base.html' %} {% block content %}
<div class="card">
  <div class="card-body">
    <h5 title="Show all Lecturers" class="card-title fw-semibold mb-4">
      All Lecturers
    </h5>
    <!--<p class="mb-0"></p>-->
    {% with messages = get_flashed_messages(with_categories=true) %} {% if
    messages %} {% for category, message in messages %}
    <div class="alert alert-{{ category }}">{{ message }}</div>
    {% endfor %} {% endif %} {% endwith %}
    <table
      id="studentTable"
      class="table table-striped table-borderless"
      width="100%"
    >
      <thead>
        <tr>
          <th>#</th>
          <th>Title</th>
          <th>First name</th>
          <th>Last name</th>
          <th>Sex</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for lecturer in lecturers %}
        <tr>
          <td>{{loop.index}}</td>
          <td>{{lecturer['title']}}</td>
          <td>{{lecturer['first_name']}}</td>
          <td>{{lecturer['last_name']}}</td>
          <td>{{ lecturer['sex']}}</td>
          <td>
            <a
              href="{{ url_for('admin_views.modify_lecturer', id=lecturer['id']) }}"
            >
              <i class="fa fa-pen mx-3"></i>
            </a>
            <a
              href="#"
              data-toggle="modal"
              data-target="#deleteModal"
              data-lecturer-id="{{ lecturer['id'] }}"
            >
              <!-- Pass the lecturer's ID -->
              <i class="fa fa-trash text-danger"></i>
            </a>
          </td>
        </tr>
        {% endfor%}
      </tbody>
    </table>
  </div>
</div>

<div
  class="modal fade"
  id="deleteModal"
  tabindex="-1"
  role="dialog"
  aria-labelledby="deleteModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="deleteModalLabel">Are you sure?</h5>
        <button
          class="close"
          type="button"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true">Ã—</span>
        </button>
      </div>
      <div class="modal-body">
        Select "Logout" to delete the selected user. <b>NOTE: </b> This action
        is inreversible!
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" type="button" data-dismiss="modal">
          Cancel
        </button>
        <form method='delete' id="deleteLecturerButton" action="{{ url_for('admin_views.delete_lecturer') }}" method="delete">
          <input id="userId" type="hiden" value='' name='userId'/>
          <input type='submit' class="btn btn-danger" value='Delete'>
        </form>
      </div>
    </div>
  </div>
</div>

  <!-- Include jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
  $(document).ready(function () {
    $('#deleteModal').on('shown.bs.modal', function (event) {
      const button = event.relatedTarget; // Button that triggered the modal
      const lecturerId = $(button).data('lecturer-id'); // Get the lecturer's ID from the button
  console.log(lecturerId)
      // Update the form action with the lecturer's ID
      //const deleteForm = $('#deleteLecturerButton');
      //deleteForm.attr('action', `/admin/lecturers/delete?id=${lecturerId}`);

      // Set the lecturer's ID in the hidden input field
      $('#userId').val(lecturerId);
      console.log($('#userId'))
    });
  });


</script>


{% endblock content %}
